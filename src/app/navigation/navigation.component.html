<header class="navbar" [class.hidden]="isNavbarHidden" role="banner">
  <div
    class="navbar__brand"
    role="button"
    tabindex="0"
    (click)="navigateToHome()"
    (keydown.enter)="navigateToHome()"
  >
    SHEIN TRADERS
  </div>

  <button
    class="navbar__toggle"
    (click)="toggleMenu()"
    aria-label="Toggle menu"
    [attr.aria-expanded]="isNavbarOpen"
    aria-controls="main-navigation"
  >
    <svg
      *ngIf="!isNavbarOpen"
      xmlns="http://www.w3.org/2000/svg"
      class="icon"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        d="M3 6h18M3 12h18M3 18h18"
        stroke="currentColor"
        stroke-width="2"
        fill="none"
        stroke-linecap="round"
      />
    </svg>
    <svg
      *ngIf="isNavbarOpen"
      xmlns="http://www.w3.org/2000/svg"
      class="icon"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        d="M6 18L18 6M6 6l12 12"
        stroke="currentColor"
        stroke-width="2"
        fill="none"
        stroke-linecap="round"
      />
    </svg>
  </button>

  <nav
    id="main-navigation"
    class="navbar__menu"
    [class.open]="isNavbarOpen"
    role="navigation"
    aria-label="Primary Navigation"
  >
    <a
      role="link"
      tabindex="0"
      (click)="navigateToHome()"
      [class.active]="currentSection === 'home'"
      [attr.aria-current]="currentSection === 'home' ? 'page' : null"
    >
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
        <path
          d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
          stroke="currentColor"
          stroke-width="2"
          fill="none"
        />
      </svg>
      {{ "NAV.HOME" | translate }}
    </a>

    <div class="dropdown-container">
      <button
        class="dropdown-btn"
        type="button"
        [class.active]="
          currentSection === 'client' || currentSection === 'clientsList'
        "
        (click)="toggleClientsDropdown()"
        aria-haspopup="true"
        [attr.aria-expanded]="isClientsDropdownOpen"
        aria-controls="clients-dropdown-menu"
      >
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
        </svg>
        {{ selectedClientLabel | translate }}
        <svg
          class="icon dropdown-icon"
          [class.rotated]="isClientsDropdownOpen"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            d="M6 9l6 6 6-6"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
          />
        </svg>
      </button>

      <div
        id="clients-dropdown-menu"
        class="dropdown-menu"
        [class.open]="isClientsDropdownOpen"
        role="menu"
        aria-label="Clients submenu"
      >
        <a
          role="menuitem"
          tabindex="0"
          (click)="navigateToClient()"
          [class.active]="currentSection === 'client'"
          [attr.aria-current]="currentSection === 'client' ? 'page' : null"
        >
          {{ "NAV.CLIENTS" | translate }}
        </a>
        <a
          role="menuitem"
          tabindex="0"
          (click)="navigateToList()"
          [class.active]="currentSection === 'clientsList'"
          [attr.aria-current]="currentSection === 'clientsList' ? 'page' : null"
        >
          {{ "clientsList" | translate }}
        </a>
      </div>
    </div>

    <a
      role="link"
      tabindex="0"
      (click)="navigateToAnalytics()"
      [class.active]="currentSection === 'analytics'"
      [attr.aria-current]="currentSection === 'analytics' ? 'page' : null"
    >
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
        <path
          d="M3 3v18h18"
          stroke="currentColor"
          stroke-width="2"
          fill="none"
        />
        <path
          d="M18 9l-4 4-5-5-4 4"
          stroke="currentColor"
          stroke-width="2"
          fill="none"
        />
      </svg>
      {{ "NAV.ANALYTICS" | translate }}
    </a>

    <a
      role="link"
      tabindex="0"
      (click)="navigateToAbout()"
      [class.active]="currentSection === 'about'"
      [attr.aria-current]="currentSection === 'about' ? 'page' : null"
    >
      <svg
        class="icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="1.8"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
      >
        <rect x="3" y="3" width="18" height="18" rx="4" />
        <line x1="12" y1="8" x2="12" y2="8" />
        <line x1="12" y1="12" x2="12" y2="16" />
      </svg>
      {{ "NAV.ABOUT" | translate }}
    </a>

    <div class="dropdown-container">
      <button
        class="dropdown-btn"
        type="button"
        [class.active]="
          currentSection === 'settings' || currentSection === 'history'
        "
        (click)="toggleDropdown()"
        aria-haspopup="true"
        [attr.aria-expanded]="isDropdownOpen"
        aria-controls="settings-dropdown-menu"
      >
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <circle
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
          />
          <path
            d="M12 8v4l3 3"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
          />
        </svg>
        {{ selectedSettingsLabel | translate }}
        <svg
          class="icon dropdown-icon"
          [class.rotated]="isDropdownOpen"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            d="M6 9l6 6 6-6"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
          />
        </svg>
      </button>

      <div
        id="settings-dropdown-menu"
        class="dropdown-menu"
        [class.open]="isDropdownOpen"
        role="menu"
        aria-label="Settings submenu"
      >
        <a
          role="menuitem"
          tabindex="0"
          (click)="navigateToSettings()"
          [class.active]="currentSection === 'settings'"
          [attr.aria-current]="currentSection === 'settings' ? 'page' : null"
        >
          {{ "NAV.SETTINGS" | translate }}
        </a>
        <a
          role="menuitem"
          tabindex="0"
          (click)="navigateToHistory()"
          [class.active]="currentSection === 'history'"
          [attr.aria-current]="currentSection === 'history' ? 'page' : null"
        >
          {{ "NAV.HISTORY" | translate }}
        </a>
      </div>
    </div>

    <div class="navbar__status-logout">
      <app-version-alert></app-version-alert>
      <button
        class="navbar__logout"
        (click)="logout()"
        aria-label="Log out"
        type="button"
      >
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M17 16l4-4-4-4M7 12h14M3 6v12"
            stroke="currentColor"
            stroke-width="2"
            fill="none"
          />
        </svg>
      </button>
    </div>
  </nav>
</header>

<app-loader *ngIf="isLoading" [message]="'Logging out...'"></app-loader>

<main class="main-content" role="main">
  <router-outlet></router-outlet>
</main>
